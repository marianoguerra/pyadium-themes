latest version of this code is in emesene project see github.com/emesene/emesene